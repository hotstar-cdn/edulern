<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Results</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="main-container">
        <div class="results-content" id="results-container">
             <!-- Results will be generated by JavaScript -->
             <p>Calculating results...</p>
        </div>
         <div id="error-container" style="display: none; padding: 20px; text-align: center;">
            <h2>No Results Found</h2>
            <p>Could not find any quiz results. Please complete a quiz first.</p>
        </div>
    </div>
    
    <script src="data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const resultsContainer = document.getElementById('results-container');
            const errorContainer = document.getElementById('error-container');
            const resultData = JSON.parse(localStorage.getItem('quizResult'));

            if (!resultData) {
                resultsContainer.style.display = 'none';
                errorContainer.style.display = 'block';
                return;
            }

            const { questions, userAnswers, totalTime } = resultData;
            const totalQuestions = questions.length;
            let correctCount = 0;

            questions.forEach(q => {
                if (userAnswers[q.id] === q.correct_answer) {
                    correctCount++;
                }
            });
            
            // Assuming 1 mark per question
            const marksObtained = correctCount;
            const totalMarks = totalQuestions;
            
            const avgTime = totalQuestions > 0 ? (totalTime / totalQuestions).toFixed(1) : 0;

            const resultsHtml = `
                <div class="icon">‚≠ê</div>
                <h2>You could do better!</h2>
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="value">${correctCount}/${totalQuestions}</div>
                        <div class="label">Correct</div>
                    </div>
                    <div class="stat-box">
                        <div class="value">${marksObtained}/${totalMarks}</div>
                        <div class="label">Marks</div>
                    </div>
                    <div class="stat-box">
                        <div class="value">${avgTime}s</div>
                        <div class="label">Avg. time</div>
                    </div>
                </div>
                <button class="btn btn-primary" id="review-btn">Review solutions</button>
            `;
            resultsContainer.innerHTML = resultsHtml;

            document.getElementById('review-btn').addEventListener('click', () => {
                window.location.href = '3_review.html';
            });
        });
    </script>
</body>
</html>

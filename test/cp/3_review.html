<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Answers</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="main-container">
        <div class="header">
            <h1>Review Answers</h1>
        </div>
        <div class="content" id="review-container">
            <!-- Review list will be generated by JavaScript -->
        </div>
         <div id="error-container" style="display: none; padding: 20px; text-align: center;">
            <h2>No Results to Review</h2>
            <p>Could not find any quiz results to review. Please complete a quiz first.</p>
        </div>
    </div>
    
    <script src="data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const reviewContainer = document.getElementById('review-container');
            const errorContainer = document.getElementById('error-container');
            const resultData = JSON.parse(localStorage.getItem('quizResult'));

            if (!resultData) {
                reviewContainer.style.display = 'none';
                errorContainer.style.display = 'block';
                return;
            }

            const { questions, userAnswers } = resultData;
            let reviewHtml = '<div class="review-list">';

            questions.forEach((q, index) => {
                const userAnswer = userAnswers[q.id];
                const isCorrect = userAnswer === q.correct_answer;

                let optionsDetailsHtml = '';
                q.options.forEach(opt => {
                    let optionClass = 'option';
                    if (opt.id === q.correct_answer) {
                        optionClass += ' correct-answer';
                    } else if (opt.id === userAnswer) {
                        optionClass += ' user-answer-wrong';
                    }

                    optionsDetailsHtml += `
                        <div class="${optionClass}">
                           <div class="option-content">
                                <span class="option-id">${opt.id}</span>
                                <div class="option-value">
                                    ${opt.text ? `<span>${opt.text}</span>` : ''}
                                    ${opt.image ? `<div class="option-image"><img src="${opt.image}" alt="Option ${opt.id}"></div>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });

                reviewHtml += `
                    <div class="question-item">
                        <details>
                            <summary>Question ${index + 1} ${isCorrect ? '✔️' : '❌'}</summary>
                            <div class="review-details">
                                <p class="question-text">${q.question_text}</p>
                                ${q.question_image ? `<div class="question-image"><img src="${q.question_image}" alt="Question Image"></div>` : ''}
                                <div class="options-container">${optionsDetailsHtml}</div>
                                <div class="solution-box">
                                    <h4>Solution</h4>
                                    <p>${q.solution_text}</p>
                                    ${q.solution_image ? `<div class="solution-image"><img src="${q.solution_image}" alt="Solution Image"></div>` : ''}
                                </div>
                            </div>
                        </details>
                    </div>
                `;
            });

            reviewHtml += '</div>';
            reviewContainer.innerHTML = reviewHtml;
        });
    </script>
</body>
</html>
